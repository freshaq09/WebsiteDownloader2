{% extends 'base.html' %}

{% block title %}API Documentation{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-10 mx-auto">
            <div class="card shadow-sm mb-5">
                <div class="card-body">
                    <h1 class="mb-4">Website Downloader API Documentation</h1>
                    
                    <p class="lead">
                        Our API allows you to programmatically download entire websites as Netlify-ready ZIP archives.
                        With a single API call, you can generate a deployable ZIP file for any website.
                    </p>
                    
                    <div class="alert alert-info">
                        <strong>Need an API key?</strong> 
                        {% if current_user.is_authenticated %}
                            <a href="{{ url_for('dashboard') }}" class="alert-link">Visit your dashboard</a> to manage your API keys.
                        {% else %}
                            <a href="{{ url_for('register') }}" class="alert-link">Register for an account</a> to get your API key.
                        {% endif %}
                    </div>
                    
                    <h2 class="mt-4 mb-3">Authentication</h2>
                    <p>
                        All API requests require authentication using an API key. You can include your API key in one of two ways:
                    </p>
                    
                    <ul>
                        <li>As a header: <code>X-API-Key: YOUR_API_KEY</code></li>
                        <li>As a query parameter: <code>?api_key=YOUR_API_KEY</code></li>
                    </ul>
                    
                    <h2 class="mt-4 mb-3">Endpoints</h2>
                    
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span class="badge bg-success">POST</span>
                            <code class="ms-3">/api/v1/fast_wget</code>
                            <span class="ms-auto">Download a website</span>
                        </div>
                        <div class="card-body">
                            <p>
                                Download an entire website and receive a Netlify-ready ZIP file in return.
                                This endpoint uses our high-speed wget implementation.
                            </p>
                            
                            <h5>Request Body (JSON)</h5>
                            <pre class="bg-light p-3 rounded"><code>{
  "url": "https://example.com"
}
</code></pre>
                            
                            <h5 class="mt-3">Parameters</h5>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Parameter</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>url</code></td>
                                        <td>string</td>
                                        <td>Yes</td>
                                        <td>The URL of the website to download</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <h5 class="mt-3">Response</h5>
                            <p>
                                The response will be a ZIP file containing the downloaded website.
                                The <code>Content-Type</code> header will be set to <code>application/zip</code>.
                            </p>
                            
                            <h5 class="mt-3">Example</h5>
                            <p>Using curl:</p>
                            <pre class="bg-light p-3 rounded"><code>curl -X POST \
  -H "X-API-Key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"url": "https://example.com"}' \
  --output website.zip \
  https://your-app-url.replit.app/api/v1/fast_wget</code></pre>
                            
                            <p>Using JavaScript:</p>
                            <pre class="bg-light p-3 rounded"><code>const response = await fetch('https://your-app-url.replit.app/api/v1/fast_wget', {
  method: 'POST',
  headers: {
    'X-API-Key': 'YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    url: 'https://example.com'
  })
});

if (response.ok) {
  // Handle the ZIP file (e.g., save it)
  const blob = await response.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'website.zip';
  a.click();
}</code></pre>
                        </div>
                    </div>
                    
                    <h2 class="mt-4 mb-3">Error Responses</h2>
                    <p>
                        The API returns standard HTTP status codes to indicate success or failure.
                        In case of an error, the response body will contain an error message:
                    </p>
                    <pre class="bg-light p-3 rounded"><code>{
  "error": "Error message description"
}</code></pre>
                    
                    <table class="table table-bordered mt-3">
                        <thead>
                            <tr>
                                <th>Status Code</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>200</td>
                                <td>Success - The request was successful</td>
                            </tr>
                            <tr>
                                <td>400</td>
                                <td>Bad Request - The request is invalid</td>
                            </tr>
                            <tr>
                                <td>401</td>
                                <td>Unauthorized - API key is missing or invalid</td>
                            </tr>
                            <tr>
                                <td>500</td>
                                <td>Server Error - Something went wrong on our end</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h2 class="mt-4 mb-3">Rate Limits</h2>
                    <p>
                        There are currently no rate limits on the API, but please be considerate
                        and avoid sending excessive requests. Excessive usage may result in your API
                        key being temporarily or permanently disabled.
                    </p>
                    
                    <h2 class="mt-4 mb-3">Support</h2>
                    <p>
                        If you have any questions or need help using the API, please contact our support team.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}